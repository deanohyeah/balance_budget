/** Global variable **//*global init */function calculateDiv(){var e=$(".budget_container");e.height(browserHeight-50);var t=e.height(),n=Math.abs($("#deficit_label").attr("data")),r=2e9,i=$(".axis_label");$(".bottom_container li").each(function(){var e=$(this).attr("data"),i=e*t/(r+n);$(this).height(i)});$(".line").each(function(e){var s=parseInt($(this).attr("data"))+n,o=s*t/(parseInt(r)+parseInt(n));$(this).css("bottom",o);i.eq(e).css("bottom",o)})}function init(){$(".proposal").on({dragstart:dragStart,dragend:dragEnd,hover:proposalHover,click:clickDrop}).attr("draggable","true");$(".budget_proposal_container, .proposal_container").on({dragenter:dragEnter,drop:dragDrop,dragover:dragOver});$(".icon-info").click(function(){$(this).find(".proposal_info").toggle();event.stopPropagation()})}function proposalHover(e){var t=e.type=="mouseenter",n=$(this);n.find(".proposal_info").hide();var r=n.attr("id"),i=r.replace(/^\D+/g,"");if(t)if(r.indexOf("your_budget_section")==-1){var s=$("#your_budget_section"+i);if(s.css("display")=="list-item"){s.addClass("connected_proposal");n.addClass("connected_proposal")}}else{$("#section"+i).addClass("connected_proposal");n.addClass("connected_proposal")}else if(r.indexOf("your_budget_section")==-1){var s=$("#your_budget_section"+i);if(s.css("display")=="list-item"){s.removeClass("connected_proposal");n.removeClass("connected_proposal")}}else{$("#section"+i).removeClass("connected_proposal");n.removeClass("connected_proposal")}n.toggleClass("active")}function dragStart(e){var t=$(e.target).hasClass("inactive");if(t)return!1;e.dataTransfer.effectAllowed="move";e.dataTransfer.setData("Text",e.target.getAttribute("id"));$(".budget_container").addClass("active")}function dragEnd(){$(".budget_container").removeClass("active")}function dragEnter(){return!1}function dragOver(){return!1}function dragDrop(e){var t=e.dataTransfer.getData("Text");proposalLogic(t);e.stopPropagation();return!1}function clickDrop(){var e=$(this).attr("id"),t=$(this).hasClass("inactive");proposalLogic(e)}function proposalLogic(e){var t=e.indexOf("your_budget_");if(t!=-1)var n=$(".budget_proposal_container #"+e);else var n=$(".budget_proposal_container #your_budget_"+e);var r=n.height(),i=$(".proposal_section #"+e.replace("your_budget_","")),s=parseFloat(i.attr("data"));if(!i.hasClass("inactive")){if(calculateBudget(r)){n.slideDown();i.addClass("inactive");currentBudgetTotal+=s;$("#balance_total").text(convertMoney(currentBudgetTotal)+currentBudgetAbrev)}else window.alert("Amount exceeds capacity. You only need $1.7B to meet the highest goal for education funding. Your current budget: "+convertMoney(currentBudgetTotal)+currentBudgetAbrev);return}if(i.hasClass("inactive")){if(calculateBudget(-r)){n.slideUp();i.removeClass("inactive");currentBudgetTotal-=s;$("#balance_total").text(convertMoney(currentBudgetTotal)+currentBudgetAbrev);i.removeClass("connected_proposal")}else window.alert("An error occurred when trying to remove a proposal...");return}}function calculateBudget(e){var t=$(".budget_proposal_container").height(),n=0;$(".bottom_container").height()>0&&(n=$(".bottom_container").height());var r=n+e;if(r<t){checkBenchmarks(n,r);return!0}return!1}function checkBenchmarks(e,t){$(".line").each(function(){var n=$(this).css("bottom"),r=parseInt(n,10);if(e<r&&t>=r){var i=$(".axis_label").filter(function(){return $(this).css("bottom")==n});i.append('<div class="icon-checkmark reached_goal"></div>').addClass("active")}if(e>=r&&t<r){var i=$(".axis_label").filter(function(){return $(this).css("bottom")==n});i.removeClass("active").find(".icon-checkmark").remove()}})}function convertMoney(e){var t=!1;if(e<0){e*=-1;t=!0}e=e.toString();var n=e.length;e=parseInt(e,10);if(n>=10){e/=1e9;currentBudgetAbrev="B"}if(n<10){e/=1e6;currentBudgetAbrev="M"}e=parseFloat(e).toFixed(2);e===0&&(currentBudgetAbrev="");t?e="-$"+e:e="$"+e;return e}function fixedHeader(){var e;window.FileReader&&Modernizr.draganddrop?e="Drag proposal options here to balance your budget.":e="Click proposal options on the left to balance your budget.";document.getElementById("instructions").innerHTML=e;var t=$("#budgetUnique"),n=$(".budget"),r=n.height(),i=$("#proposal_bottom"),s,o,u,a=50,f,l;t.width(n.width());$(window).scroll(function(){if(!s&&!o){s=n.offset().top-a;o=i.offset().top-r-a}u=$(window).scrollTop();if(u>s){if(!f){t.addClass("fixed");f=!0}}else if(f){t.removeClass("fixed");n.removeClass("hug_footer");f=!1;l=!1}if(u>o&&!l){t.removeClass("fixed");n.addClass("hug_footer");f=!0;l=!0}else if(l&&u<o){f=!1;l=!1}})}var currentBudgetTotal=0,currentBudgetAbrev="M",browserHeight=window.innerHeight;$.event.props.push("dataTransfer");$(document).ready(function(){init();currentBudgetTotal=parseInt($("#deficit_label").attr("data"),10);$("#balance_total").text(convertMoney(currentBudgetTotal)+currentBudgetAbrev);var e=$(".budget"),t=e.height();t>browserHeight&&calculateDiv();fixedHeader()});